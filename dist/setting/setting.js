System.register(["jimu-core","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector","jimu-ui","jimu-theme","jimu-arcgis"],(function(e,t){var a={},s={},o={},n={},l={},r={};return{setters:[function(e){a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React,a.css=e.css,a.hooks=e.hooks,a.jsx=e.jsx},function(e){s.MapWidgetSelector=e.MapWidgetSelector,s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection},function(e){o.DataSourceSelector=e.DataSourceSelector},function(e){n.Alert=e.Alert,n.NumericInput=e.NumericInput,n.Switch=e.Switch,n.TextArea=e.TextArea},function(e){l.useTheme=e.useTheme},function(){}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=l},2686:e=>{"use strict";e.exports=r},3089:e=>{"use strict";e.exports=o},4321:e=>{"use strict";e.exports=n},9244:e=>{"use strict";e.exports=a},9298:e=>{"use strict";e.exports=s}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var c={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(c),i.d(c,{__set_webpack_public_path__:()=>r,default:()=>l});var e=i(9244),t=i(9298),a=i(3089),s=i(4321),o=i(1888);const n=()=>(t=>{var a,s;const o=t.sys.spacing,n=t.sys.color,l=t.sys.typography;return{description:(0,e.css)({fontSize:null===(a=null==l?void 0:l.body1)||void 0===a?void 0:a.fontSize,color:null===(s=null==n?void 0:n.surface)||void 0===s?void 0:s.backgroundHint,marginBlockStart:null==o?void 0:o(1)})}})((0,o.useTheme)());i(2686);new Map,new Map;new class{constructor(){this.ownersByView=new WeakMap,this.originalStateByView=new WeakMap}acquire(e,t){if(!t)return;const a=t.popup;if(!a||"boolean"!=typeof a.autoOpenEnabled)return;let s=this.ownersByView.get(t);s||(s=new Set,this.ownersByView.set(t,s),this.originalStateByView.set(t,a.autoOpenEnabled)),s.add(e),a.autoOpenEnabled=!1}release(e,t){if(!t)return;const a=this.ownersByView.get(t);a&&a.delete(e)&&0===a.size&&this.restorePopupState(t)}restorePopupState(e){const t=e.popup,a=this.originalStateByView.get(e);t&&void 0!==a&&(t.autoOpenEnabled=a,this.originalStateByView.delete(e),this.ownersByView.delete(e))}};const l=o=>{const{config:l,id:r,onSettingChange:i,useMapWidgetIds:c}=o,u=e.hooks.useTranslation(),d=n(),p=(t=>{const a=e.hooks.useLatest(t);return e.hooks.useEventCallback(((e,t=!1)=>{var s;const o=null===(s=a.current)||void 0===s?void 0:s[e];return"boolean"==typeof o?o:t}))})(l),g=((t,a,s)=>e.hooks.useEventCallback(((e,o)=>{s({id:t,config:a.set?a.set(e,o):Object.assign(Object.assign({},a),{[e]:o})})})))(r,l,i),[b,h]=e.React.useState((()=>String(l.maxResults||50))),[S,v]=e.React.useState((()=>p("enableToggleRemoval"))),[w,f]=e.React.useState((()=>p("enablePIIMasking"))),[k,m]=e.React.useState((()=>p("enableBatchOwnerQuery",!1))),[x,j]=e.React.useState((()=>{var e;return String(null!==(e=l.relationshipId)&&void 0!==e?e:0)})),[I,y]=e.React.useState((()=>(l.allowedHosts||[]).join("\n"))),[R,E]=e.React.useState({}),O=e.hooks.useEventCallback((e=>{const t=parseInt(e,10);return isNaN(t)||t<1||t>1e3?(E((e=>Object.assign(Object.assign({},e),{maxResults:u("errorMaxResultsInvalid")}))),!1):(E((e=>Object.assign(Object.assign({},e),{maxResults:void 0}))),!0)})),C=e.hooks.useEventCallback((e=>{const t=parseInt(e,10);return isNaN(t)||t<0||t>99?(E((e=>Object.assign(Object.assign({},e),{relationshipId:u("errorRelationshipIdInvalid")}))),!1):(E((e=>Object.assign(Object.assign({},e),{relationshipId:void 0}))),!0)})),T=((t,a,s)=>{const o=Number.isFinite(a)&&a>=0?a:0,n=e.React.useRef(null),l=e.React.useRef(!1),r=e.hooks.useLatest(t),i=e.hooks.useLatest(s),c=e.hooks.useEventCallback((e=>{var t;if(l.current===e)return;l.current=e;const a=null===(t=i.current)||void 0===t?void 0:t.onPendingChange;if("function"==typeof a)try{a(e)}catch(e){}})),u=e.hooks.useEventCallback((()=>{n.current&&(clearTimeout(n.current),n.current=null),l.current&&c(!1)})),d=e.hooks.useEventCallback(((...e)=>{n.current&&clearTimeout(n.current),c(!0),n.current=setTimeout((()=>{n.current=null;try{r.current(...e)}finally{c(!1)}}),o)})),p=e.React.useRef(null),g=e.hooks.useLatest(d),b=e.hooks.useLatest(u);if(!p.current){const e=()=>{},t=(...e)=>{g.current(...e)};t.cancel=()=>b.current(),t.flush=e,p.current=t}return e.hooks.useEffectOnce((()=>()=>{b.current()})),p.current})(O,500),B=e.hooks.useEventCallback((e=>{h(String(e)),T(String(e))})),D=e.hooks.useEventCallback((()=>{T.cancel();if(O(b)){const e=parseInt(b,10);g("maxResults",e)}})),M=e.hooks.useEventCallback((e=>{const t=e.target.checked;v(t),g("enableToggleRemoval",t)})),L=e.hooks.useEventCallback((e=>{const t=e.target.checked;f(t),g("enablePIIMasking",t)})),P=e.hooks.useEventCallback((e=>{const t=e.target.checked;m(t),g("enableBatchOwnerQuery",t)})),W=e.hooks.useEventCallback((e=>{j(String(e))})),N=e.hooks.useEventCallback((()=>{if(C(x)){const e=parseInt(x,10);g("relationshipId",e)}})),V=e.hooks.useEventCallback((e=>{y(e.target.value)})),_=e.hooks.useEventCallback((()=>{const e=I.split("\n").map((e=>e.trim())).filter(Boolean);g("allowedHosts",e)})),H=e.hooks.useEventCallback((e=>{const t=null==e?void 0:e[0];(null==t?void 0:t.dataSourceId)&&i({id:r,useDataSources:[t],config:l.set("propertyDataSourceId",t.dataSourceId).set("ownerDataSourceId",t.dataSourceId)})})),U=e.hooks.useEventCallback((e=>{i({id:r,useMapWidgetIds:e})}));return e.hooks.useUpdateEffect((()=>{h(String(l.maxResults||50))}),[l.maxResults]),e.hooks.useUpdateEffect((()=>{v(p("enableToggleRemoval"))}),[l.enableToggleRemoval]),e.hooks.useUpdateEffect((()=>{f(p("enablePIIMasking"))}),[l.enablePIIMasking]),e.hooks.useUpdateEffect((()=>{m(p("enableBatchOwnerQuery",!1))}),[l.enableBatchOwnerQuery]),e.hooks.useUpdateEffect((()=>{var e;j(String(null!==(e=l.relationshipId)&&void 0!==e?e:0))}),[l.relationshipId]),e.hooks.useUpdateEffect((()=>{y((l.allowedHosts||[]).join("\n"))}),[l.allowedHosts]),e.hooks.useEffectOnce((()=>{c&&c.length>0&&console.log("Property Widget: Map configured on mount",c)})),(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(t.SettingSection,{title:u("mapWidgetTitle")},(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2},(0,e.jsx)(t.MapWidgetSelector,{onSelect:U,useMapWidgetIds:c})),(0,e.jsx)("div",{css:d.description},u("mapWidgetDescription"))),(0,e.jsx)(t.SettingSection,{title:u("dataSourcesTitle")},(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2,label:u("dataSourceLabel")},(0,e.jsx)(a.DataSourceSelector,{types:(0,e.Immutable)([e.DataSourceTypes.FeatureLayer]),useDataSources:l.propertyDataSourceId&&o.useDataSources?(0,e.Immutable)(o.useDataSources.filter((e=>e.dataSourceId===l.propertyDataSourceId))):(0,e.Immutable)([]),mustUseDataSource:!0,onChange:H,widgetId:r,hideTypeDropdown:!0})),(0,e.jsx)("div",{css:d.description},u("dataSourcesDescription"))),(0,e.jsx)(t.SettingSection,{title:u("displayOptionsTitle")},(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2,label:u("maxResultsLabel")},(0,e.jsx)(s.NumericInput,{value:parseInt(b,10),min:1,max:1e3,onChange:B,onBlur:D,"aria-label":u("maxResultsLabel"),"aria-invalid":!!R.maxResults})),R.maxResults&&(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2},(0,e.jsx)(s.Alert,{type:"error",text:R.maxResults,closable:!1})),(0,e.jsx)(t.SettingRow,{flow:"no-wrap",level:2,label:u("enableToggleRemovalLabel")},(0,e.jsx)(s.Switch,{checked:S,onChange:M,"aria-label":u("enableToggleRemovalLabel")})),(0,e.jsx)(t.SettingRow,{flow:"no-wrap",level:2,label:u("enablePIIMaskingLabel")},(0,e.jsx)(s.Switch,{checked:w,onChange:L,"aria-label":u("enablePIIMaskingLabel")})),(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2,label:u("allowedHostsLabel")},(0,e.jsx)(s.TextArea,{value:I,onChange:V,onBlur:_,placeholder:u("allowedHostsPlaceholder"),"aria-label":u("allowedHostsLabel")}))),(0,e.jsx)(t.SettingSection,{title:u("relationshipTitle")},(0,e.jsx)(t.SettingRow,{flow:"no-wrap",level:2,label:u("enableBatchOwnerQueryLabel")},(0,e.jsx)(s.Switch,{checked:k,onChange:P,"aria-label":u("enableBatchOwnerQueryLabel")})),(0,e.jsx)("div",{css:d.description},u("enableBatchOwnerQueryDescription")),k&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2,label:u("relationshipIdLabel")},(0,e.jsx)(s.NumericInput,{value:parseInt(x,10),min:0,max:99,onChange:W,onBlur:N,"aria-label":u("relationshipIdLabel"),title:u("relationshipIdTooltip"),"aria-invalid":!!R.relationshipId})),R.relationshipId&&(0,e.jsx)(t.SettingRow,{flow:"wrap",level:2},(0,e.jsx)(s.Alert,{type:"error",text:R.relationshipId,closable:!1})),(0,e.jsx)("div",{css:d.description},u("relationshipIdDescription")))))};function r(e){i.p=e}})(),c})())}}}));