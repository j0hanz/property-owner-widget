System.register(["jimu-core","jimu-ui","jimu-ui/basic/color-picker","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector","jimu-theme","jimu-arcgis"],(function(e,t){var a={},o={},l={},i={},s={},n={},r={};return{setters:[function(e){a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React,a.css=e.css,a.hooks=e.hooks,a.jsx=e.jsx},function(e){o.Alert=e.Alert,o.Button=e.Button,o.CollapsablePanel=e.CollapsablePanel,o.NumericInput=e.NumericInput,o.SVG=e.SVG,o.Slider=e.Slider,o.Switch=e.Switch,o.TextInput=e.TextInput,o.Tooltip=e.Tooltip,o.defaultMessages=e.defaultMessages},function(e){l.ColorPicker=e.ColorPicker},function(e){i.MapWidgetSelector=e.MapWidgetSelector,i.SettingRow=e.SettingRow,i.SettingSection=e.SettingSection},function(e){s.DataSourceSelector=e.DataSourceSelector},function(e){n.useTheme=e.useTheme},function(){}],execute:function(){e((()=>{var e={1601:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik04Ljc0NTQ4IDhMMTQuODQ1NiAxNC4xMDAxQzE1LjA1MTUgMTQuMzA2IDE1LjA1MTUgMTQuNjM5NyAxNC44NDU2IDE0Ljg0NTZDMTQuNjM5NyAxNS4wNTE1IDE0LjMwNiAxNS4wNTE1IDE0LjEwMDEgMTQuODQ1Nkw4IDguNzQ1NDhMMS44OTk4NyAxNC44NDU2QzEuNjk0MDEgMTUuMDUxNSAxLjM2MDI1IDE1LjA1MTUgMS4xNTQzOSAxNC44NDU2QzAuOTQ4NTM2IDE0LjYzOTcgMC45NDg1MzYgMTQuMzA2IDEuMTU0MzkgMTQuMTAwMUw3LjI1NDUyIDhMMS4xNTQzOSAxLjg5OTg3QzAuOTQ4NTM1IDEuNjk0MDEgMC45NDg1MzUgMS4zNjAyNSAxLjE1NDM5IDEuMTU0MzlDMS4zNjAyNSAwLjk0ODUzNiAxLjY5NDAxIDAuOTQ4NTM2IDEuODk5ODcgMS4xNTQzOUw4IDcuMjU0NTJMMTQuMTAwMSAxLjE1NDM5QzE0LjMwNiAwLjk0ODUzNSAxNC42Mzk3IDAuOTQ4NTM1IDE0Ljg0NTYgMS4xNTQzOUMxNS4wNTE1IDEuMzYwMjUgMTUuMDUxNSAxLjY5NDAxIDE0Ljg0NTYgMS44OTk4N0w4Ljc0NTQ4IDhaIiBmaWxsPSJibGFjayIvPg0KPC9zdmc+DQo="},1888:e=>{"use strict";e.exports=n},2686:e=>{"use strict";e.exports=r},3089:e=>{"use strict";e.exports=s},4321:e=>{"use strict";e.exports=o},4337:e=>{"use strict";e.exports=l},7519:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCINCiAgICAgICAgZD0iTTE1IDhDMTUgMTEuODY2IDExLjg2NiAxNSA4IDE1QzQuMTM0MDEgMTUgMSAxMS44NjYgMSA4QzEgNC4xMzQwMSA0LjEzNDAxIDEgOCAxQzExLjg2NiAxIDE1IDQuMTM0MDEgMTUgOFpNMTYgOEMxNiAxMi40MTgzIDEyLjQxODMgMTYgOCAxNkMzLjU4MTcyIDE2IDAgMTIuNDE4MyAwIDhDMCAzLjU4MTcyIDMuNTgxNzIgMCA4IDBDMTIuNDE4MyAwIDE2IDMuNTgxNzIgMTYgOFpNOC4zMjQwNiAxMC4yMjhINy4zNDAwNkM3LjEyNzQ1IDkuMDg5NTIgNy45NjE0MSA4LjA5ODY4IDguNzE1MSA3LjIwMzIxQzkuMjgwMTQgNi41MzE4OCA5LjgwMDA2IDUuOTE0MTUgOS44MDAwNiA1LjMyOEM5LjgwMDA2IDQuNSA5LjIwMDA2IDMuOSA3Ljk3NjA2IDMuOUM3LjE2MDA2IDMuOSA2LjQwNDA2IDQuMjYgNS43MDgwNiA0Ljk5Mkw1LjA2MDA2IDQuMzkyQzUuODUyMDYgMy41NTIgNi43ODgwNiAzIDguMDk2MDYgM0M5Ljc4ODA2IDMgMTAuODY4MSAzLjg2NCAxMC44NjgxIDUuMjQ0QzEwLjg2ODEgNi4xMDgyIDEwLjIxNTcgNi44NzIzMiA5LjU2ODM3IDcuNjMwNTJDOC44NTg0NCA4LjQ2MjA2IDguMTU0NTggOS4yODY0OCA4LjMyNDA2IDEwLjIyOFpNOC42MjQwNiAxMi40QzguNjI0MDYgMTIuODggOC4yNzYwNiAxMy4xOTIgNy44NTYwNiAxMy4xOTJDNy40MjQwNiAxMy4xOTIgNy4wNzYwNiAxMi44OCA3LjA3NjA2IDEyLjRDNy4wNzYwNiAxMS45MiA3LjQyNDA2IDExLjU5NiA3Ljg1NjA2IDExLjU5NkM4LjI3NjA2IDExLjU5NiA4LjYyNDA2IDExLjkyIDguNjI0MDYgMTIuNFoiDQogICAgICAgIGZpbGw9ImJsYWNrIiAvPg0KPC9zdmc+"},9244:e=>{"use strict";e.exports=a},9298:e=>{"use strict";e.exports=i},9935:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik03LjUgMEM3LjIyMzg2IDAgNyAwLjIyMzg1OCA3IDAuNVY3SDAuNUMwLjIyMzg1OCA3IDAgNy4yMjM4NiAwIDcuNUMwIDcuNzc2MTQgMC4yMjM4NTggOCAwLjUgOEg3VjE0LjVDNyAxNC43NzYxIDcuMjIzODYgMTUgNy41IDE1QzcuNzc2MTQgMTUgOCAxNC43NzYxIDggMTQuNVY4SDE0LjVDMTQuNzc2MSA4IDE1IDcuNzc2MTQgMTUgNy41QzE1IDcuMjIzODYgMTQuNzc2MSA3IDE0LjUgN0g4VjAuNUM4IDAuMjIzODU4IDcuNzc2MTQgMCA3LjUgMFoiIGZpbGw9ImJsYWNrIi8+DQo8L3N2Zz4NCg=="}},t={};function u(a){var o=t[a];if(void 0!==o)return o.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,u),l.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var a in t)u.o(t,a)&&!u.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var c={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(c),u.d(c,{__set_webpack_public_path__:()=>m,default:()=>y});var e=u(9244),t=u(4321),a=u(4337),o=u(9298),l=u(3089);const i={configurationInstructions:"Configure the widget by providing layer URLs and display preferences.",mapWidgetTitle:"Map connection",mapWidgetDescription:"Link the map widget that triggers parcel lookups.",dataSourcesDescription:"Ensure property and owner layers share matching FNR fields.",propertyDataSourceLabel:"Property layer",propertyDataSourceDescription:"Parcel layer containing geometry and FNR values.",ownerDataSourceLabel:"Owner layer",ownerDataSourceDescription:"Owner layer or table with NAMN and BOSTADR details.",displayOptionsTitle:"Display options",panelDisplaySettings:"Display behavior",advancedSettingsTitle:"Advanced settings",panelHighlightSettings:"Highlight styling",highlightColorLabelTooltip:"Set highlight color for parcels.",highlightOpacityLabelTooltip:"Set fill opacity for highlighted parcels.",maxResultsLabel:"Maximum results",maxResultsDescription:"Limit parcel queries to protect performance.",resetMaxResults:"Reset to default",enableToggleRemovalLabel:"Toggle removal",enableToggleRemovalDescription:"Let users click a parcel again to clear it.",enablePIIMaskingLabel:"PII masking",enablePIIMaskingDescription:"Mask names and addresses inside the widget.",autoZoomOnSelectionLabel:"Auto zoom to results",autoZoomOnSelectionDescription:"Zoom to selected parcels after each query.",highlightOptionsDescription:"Adjust how selected parcels appear on the map.",highlightColorLabel:"Highlight color",highlightOpacityLabel:"Fill opacity",highlightOutlineWidthLabel:"Outline width",highlightOutlineWidthLabelTooltip:"Set the outline width for highlighted parcels.",allowedHostsLabel:"Allowed hosts",allowedHostsDescription:"Whitelist HTTPS hosts that should pass URL checks.",allowedHostsPlaceholder:"lund.se",addAllowedHostLabel:"Add allowed host",allowedHostsListLabel:"Allowed host entries",allowedHostsEmptyHint:"No allowed hosts yet.",removeAllowedHostLabel:"Remove allowed host",enableBatchOwnerQueryLabel:"Batch owner queries",enableBatchOwnerQueryDescription:"Use a relationship to fetch all owners in one request.",relationshipIdLabel:"Relationship ID",relationshipIdDescription:"Relationship ID that links parcels to owner records.",relationshipIdPlaceholder:"e.g., 0, 1, 2",relationshipIdTooltip:"Open /MapServer/[layerId]?f=json to list relationship IDs.",errorInvalidUrl:"Enter a valid ArcGIS REST service URL.",errorInvalidNumber:"Enter a whole number greater than zero.",errorMaxResultsInvalid:"Max results must be between 1 and 1000.",errorRelationshipIdInvalid:"Relationship ID must be between 0 and 99."};var s=u(1888);const n=(t,a={})=>(0,e.css)(Object.assign({display:"flex",flexFlow:`${t} nowrap`},a)),r=()=>(t=>{var a,o;const l=t.sys.spacing,i=t.sys.typography;return{row:(0,e.css)({width:"100%",margin:"16px 0 !important"}),fullWidth:n("column",{inlineSize:"100%",flex:"1 1 auto",minInlineSize:0}),labelWithTooltip:n("row",{alignItems:"center",gap:null==l?void 0:l(1)}),tooltipTrigger:(0,e.css)({margin:"0 !important",padding:"0 !important",opacity:.6,"&:hover":{opacity:1}}),description:(0,e.css)({fontSize:null===(a=null==i?void 0:i.body2)||void 0===a?void 0:a.fontSize,marginBlockStart:null==l?void 0:l(1)}),sliderWrap:n("column",{inlineSize:"100%"}),sliderTrack:n("row",{alignItems:"center",inlineSize:"100%",gap:null==l?void 0:l(2)}),sliderControl:(0,e.css)({flex:"1 1 auto",inlineSize:"100%"}),sliderValue:(0,e.css)({textAlign:"right",fontSize:null===(o=null==i?void 0:i.label2)||void 0===o?void 0:o.fontSize}),allowedHostInputRow:n("row",{inlineSize:"100%",alignItems:"center"}),allowedHostInput:(0,e.css)({flex:"1 1 auto",inlineSize:"100%",minInlineSize:0}),allowedHostList:n("column",{inlineSize:"100%",".input-wrapper":{background:"transparent !important",borderColor:"rgb(106, 106, 106) !important"},"&.disabled .input-wrapper, &.readonly .input-wrapper":{background:"transparent !important",borderColor:"rgb(106, 106, 106) !important",opacity:1,color:"rgb(168, 168, 168)",WebkitTextFillColor:"rgb(168, 168, 168)"}}),addAllowedHostButton:(0,e.css)({border:"none !important"}),allowedHostListRow:n("row",{inlineSize:"100%",alignItems:"center"}),allowedHostListInput:(0,e.css)({flex:"1 1 auto",inlineSize:"100%",minInlineSize:0})}})((0,s.useTheme)());u(2686);const d="#00B4D8",g=e=>{if(!e)return"";return((new DOMParser).parseFromString(e,"text/html").body.textContent||"").replace(/[\s\u00A0\u200B]+/g," ").trim()},p=e=>g(e);new class{constructor(){this.ownersByView=new WeakMap,this.originalStateByView=new WeakMap}acquire(e,t){if(!t)return;const a=t.popupEnabled;if("boolean"!=typeof a)return;let o=this.ownersByView.get(t);o||(o=new Set,this.ownersByView.set(t,o),this.originalStateByView.set(t,a)),o.add(e),t.popupEnabled=!1}release(e,t){if(!t)return;const a=this.ownersByView.get(t);a&&a.delete(e)&&0===a.size&&this.restorePopupState(t)}restorePopupState(e){const t=this.originalStateByView.get(e);void 0!==t&&(e.popupEnabled=t,this.originalStateByView.delete(e),this.ownersByView.delete(e))}};var h=u(9935),I=u.n(h),w=u(1601),M=u.n(w),b=u(7519),D=u.n(b);const S=(e,t,a)=>Number.isFinite(e)?e<t?t:e>a?a:e:t,j=e=>`${S(Math.round(e),0,100)}%`,x=e=>{const t=S(e,.5,10);return Math.round(2*t)/2},N=e=>{const t=x(e),a=Math.round(t);return Math.abs(t-a)<1e-4?String(a):t.toFixed(1)},v=e=>(e=>p(e))(e||"").trim(),y=s=>{const{config:n,id:u,onSettingChange:c,useMapWidgetIds:g}=s,p=e.hooks.useTranslation(t.defaultMessages,i),h=r(),w=(a,o)=>{const l=p(a),i=p(o);return(0,e.jsx)("div",{css:h.labelWithTooltip},(0,e.jsx)("span",null,l),(0,e.jsx)(t.Tooltip,{title:i,placement:"top",showArrow:!0},(0,e.jsx)(t.Button,{type:"tertiary",icon:!0,"aria-label":i,css:h.tooltipTrigger},(0,e.jsx)(t.SVG,{src:D()}))))},b=e=>{if(!e)return null;const t=e.asMutable;return"function"==typeof t?t.call(e,{deep:!0}):e},y=t=>{if(!t||!s.useDataSources)return(0,e.Immutable)([]);const a=s.useDataSources,o="function"==typeof a.filter?a.filter((e=>(null==e?void 0:e.dataSourceId)===t)):[],l="function"==typeof(null==o?void 0:o.asMutable)?o.asMutable({deep:!0}):o;return(0,e.Immutable)(l)},m=(t=>{const a=e.hooks.useLatest(t);return e.hooks.useEventCallback(((e,t=!1)=>{var o;const l=null===(o=a.current)||void 0===o?void 0:o[e];return"boolean"==typeof l?l:t}))})(n),A=((t,a,o)=>e.hooks.useEventCallback(((e,l)=>{o({id:t,config:a.set?a.set(e,l):Object.assign(Object.assign({},a),{[e]:l})})})))(u,n,c),[T,f]=e.React.useState((()=>String(n.maxResults||50))),[L,k]=e.React.useState((()=>m("enableToggleRemoval"))),[O,C]=e.React.useState((()=>m("enablePIIMasking"))),[E,z]=e.React.useState((()=>m("enableBatchOwnerQuery",!1))),[R,Q]=e.React.useState((()=>{var e;return String(null!==(e=n.relationshipId)&&void 0!==e?e:0)})),[U,H]=e.React.useState(""),[W,B]=e.React.useState((()=>Array.from(new Set((n.allowedHosts||[]).map((e=>v(e))).filter(Boolean))))),[P,Y]=e.React.useState((()=>m("autoZoomOnSelection",!1))),[Z,F]=e.React.useState(n.highlightColor||d),[V,G]=e.React.useState((()=>{const e="number"==typeof n.highlightOpacity?n.highlightOpacity:.4;return S(e,0,1)})),[_,J]=e.React.useState((()=>{const e="number"==typeof n.outlineWidth?n.outlineWidth:2;return x(e)})),[X,q]=e.React.useState({}),$=e.hooks.useEventCallback((e=>{const t=parseInt(e,10);return isNaN(t)||t<1||t>1e3?(q((e=>Object.assign(Object.assign({},e),{maxResults:p("errorMaxResultsInvalid")}))),!1):(q((e=>Object.assign(Object.assign({},e),{maxResults:void 0}))),!0)})),K=e.hooks.useEventCallback((e=>{const t=parseInt(e,10);return isNaN(t)||t<0||t>99?(q((e=>Object.assign(Object.assign({},e),{relationshipId:p("errorRelationshipIdInvalid")}))),!1):(q((e=>Object.assign(Object.assign({},e),{relationshipId:void 0}))),!0)})),ee=((t,a,o)=>{const l=Number.isFinite(a)&&a>=0?a:0,i=e.React.useRef(null),s=e.React.useRef(!1),n=e.hooks.useLatest(t),r=e.hooks.useLatest(o),u=e.hooks.useEventCallback((e=>{var t;if(s.current===e)return;s.current=e;const a=null===(t=r.current)||void 0===t?void 0:t.onPendingChange;if("function"==typeof a)try{a(e)}catch(e){}})),c=e.hooks.useEventCallback((()=>{i.current&&(clearTimeout(i.current),i.current=null),s.current&&u(!1)})),d=e.hooks.useEventCallback(((...e)=>{i.current&&clearTimeout(i.current),u(!0),i.current=setTimeout((()=>{i.current=null;try{n.current(...e)}finally{u(!1)}}),l)})),g=e.React.useRef(null),p=e.hooks.useLatest(d),h=e.hooks.useLatest(c);if(!g.current){const e=()=>{},t=(...e)=>{p.current(...e)};t.cancel=()=>h.current(),t.flush=e,g.current=t}return e.hooks.useEffectOnce((()=>()=>{h.current()})),g.current})($,500),te=e.hooks.useEventCallback((e=>{f(String(e)),ee(String(e))})),ae=e.hooks.useEventCallback((()=>{ee.cancel();if($(T)){const e=parseInt(T,10);A("maxResults",e)}})),oe=e.hooks.useEventCallback((e=>{const t=e.target.checked;k(t),A("enableToggleRemoval",t)})),le=e.hooks.useEventCallback((e=>{const t=e.target.checked;C(t),A("enablePIIMasking",t)})),ie=e.hooks.useEventCallback((e=>{const t=e.target.checked;z(t),A("enableBatchOwnerQuery",t)})),se=e.hooks.useEventCallback((e=>{const t=Math.max(0,Math.min(99,Math.round(e)));Q(String(t))})),ne=e.hooks.useEventCallback((()=>{if(K(R)){const e=parseInt(R,10);A("relationshipId",e)}})),re=e.hooks.useEventCallback((e=>{H(e.target.value)})),ue=e.hooks.useEventCallback((()=>{const e=v(U);if(!e)return void H("");if(W.includes(e))return;const t=[...W,e];B(t),A("allowedHosts",t),H("")})),ce=e.hooks.useEventCallback((e=>{const t=v(e),a=W.filter((e=>e!==t));a.length!==W.length&&(B(a),A("allowedHosts",a))})),de=e.hooks.useEventCallback((e=>{"Enter"===e.key&&(e.preventDefault(),Oe&&ue())})),ge=e.hooks.useEventCallback((e=>{const t=e.target.checked;Y(t),A("autoZoomOnSelection",t)})),pe=e.hooks.useEventCallback((e=>{const t=e||d;F(t),A("highlightColor",t)})),he=e.hooks.useEventCallback((e=>{var t,a;const o=Number.parseFloat(null!==(a=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)&&void 0!==a?a:"");if(!Number.isFinite(o))return;const l=S(Math.round(o),0,100),i=S(l,0,100)/100;Math.abs(V-i)<1e-4||(G(i),A("highlightOpacity",i))})),Ie=e.hooks.useEventCallback((e=>{var t,a;const o=Number.parseFloat(null!==(a=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)&&void 0!==a?a:"");if(!Number.isFinite(o))return;const l=x(o);Math.abs(_-l)<1e-4||(J(l),A("outlineWidth",l))})),we=e.hooks.useEventCallback((e=>{var t,a,o,l,i;const r=null!==(t=null==e?void 0:e[0])&&void 0!==t?t:null,d=null!==(a=null==r?void 0:r.dataSourceId)&&void 0!==a?a:"",g=null!==(i=null===(l=null===(o=s.useDataSources)||void 0===o?void 0:o.find)||void 0===l?void 0:l.call(o,(e=>(null==e?void 0:e.dataSourceId)===n.ownerDataSourceId)))&&void 0!==i?i:null,p=b(g),h=!!d&&!n.ownerDataSourceId||!!d&&n.ownerDataSourceId&&n.ownerDataSourceId===n.propertyDataSourceId,I=[];r&&I.push(r),p&&p.dataSourceId&&p.dataSourceId!==d&&!h&&I.push(p);const w=h?n.set("propertyDataSourceId",d).set("ownerDataSourceId",d):n.set("propertyDataSourceId",d);c({id:u,useDataSources:I,config:w})})),Me=e.hooks.useEventCallback((e=>{var t,a,o,l,i;const r=null!==(t=null==e?void 0:e[0])&&void 0!==t?t:null,d=null!==(a=null==r?void 0:r.dataSourceId)&&void 0!==a?a:"",g=null!==(i=null===(l=null===(o=s.useDataSources)||void 0===o?void 0:o.find)||void 0===l?void 0:l.call(o,(e=>(null==e?void 0:e.dataSourceId)===n.propertyDataSourceId)))&&void 0!==i?i:null;let p=b(g);!p&&n.propertyDataSourceId&&(p={dataSourceId:n.propertyDataSourceId,mainDataSourceId:n.propertyDataSourceId,rootDataSourceId:n.propertyDataSourceId});const h=[];p&&h.push(p),!r||p&&p.dataSourceId===r.dataSourceId||h.push(r);const I=n.set("ownerDataSourceId",d);c({id:u,useDataSources:h,config:I})})),be=e.hooks.useEventCallback((e=>{c({id:u,useMapWidgetIds:e})}));e.hooks.useUpdateEffect((()=>{f(String(n.maxResults||50))}),[n.maxResults]),e.hooks.useUpdateEffect((()=>{k(m("enableToggleRemoval"))}),[n.enableToggleRemoval]),e.hooks.useUpdateEffect((()=>{C(m("enablePIIMasking"))}),[n.enablePIIMasking]),e.hooks.useUpdateEffect((()=>{z(m("enableBatchOwnerQuery",!1))}),[n.enableBatchOwnerQuery]),e.hooks.useUpdateEffect((()=>{var e;Q(String(null!==(e=n.relationshipId)&&void 0!==e?e:0))}),[n.relationshipId]),e.hooks.useUpdateEffect((()=>{const e=(n.allowedHosts||[]).map((e=>v(e))).filter(Boolean),t=Array.from(new Set(e));B(t)}),[n.allowedHosts]),e.hooks.useUpdateEffect((()=>{Y(m("autoZoomOnSelection",!1))}),[n.autoZoomOnSelection]),e.hooks.useUpdateEffect((()=>{F(n.highlightColor||d)}),[n.highlightColor]),e.hooks.useUpdateEffect((()=>{const e="number"==typeof n.highlightOpacity?n.highlightOpacity:.4;G(S(e,0,1))}),[n.highlightOpacity]),e.hooks.useUpdateEffect((()=>{const e="number"==typeof n.outlineWidth?n.outlineWidth:2;J(x(e))}),[n.outlineWidth]),e.hooks.useEffectOnce((()=>{g&&g.length>0&&console.log("Property Widget: Map configured on mount",g)}));const De=Array.isArray(g)&&g.length>0,Se=Boolean(n.propertyDataSourceId),je=Boolean(n.ownerDataSourceId),xe=Se&&je,Ne=De&&xe,ve=De&&xe,ye=!ve;e.hooks.useEffectWithPreviousValues((()=>{ye&&(E&&z(!1),n.enableBatchOwnerQuery&&A("enableBatchOwnerQuery",!1),void 0!==n.relationshipId&&A("relationshipId",void 0),"0"!==R&&Q("0"),q((e=>Object.assign(Object.assign({},e),{relationshipId:void 0}))))}),[ye,E,n.enableBatchOwnerQuery,n.relationshipId,R,A]);const me=(Ae=V,Math.round(100*S(Ae,0,1)));var Ae;const Te=j(me),fe=x(_),Le=N(_),ke=v(U),Oe=ke.length>0&&!W.includes(ke),Ce=y(n.propertyDataSourceId),Ee=y(n.ownerDataSourceId);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(o.SettingSection,null,(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("mapWidgetTitle","mapWidgetDescription")},(0,e.jsx)(o.MapWidgetSelector,{onSelect:be,useMapWidgetIds:g}))),(0,e.jsx)(o.SettingSection,null,De&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("propertyDataSourceLabel","propertyDataSourceDescription")},(0,e.jsx)(l.DataSourceSelector,{types:(0,e.Immutable)([e.DataSourceTypes.FeatureLayer]),useDataSources:Ce,mustUseDataSource:!0,onChange:we,widgetId:u,hideTypeDropdown:!0})),(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("ownerDataSourceLabel","ownerDataSourceDescription")},(0,e.jsx)(l.DataSourceSelector,{types:(0,e.Immutable)([e.DataSourceTypes.FeatureLayer]),useDataSources:Ee,mustUseDataSource:!0,onChange:Me,widgetId:u,hideTypeDropdown:!0})),!xe&&(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row},(0,e.jsx)(t.Alert,{css:h.fullWidth,type:"warning",text:p("dataSourcesDescription"),closable:!1})))),Ne&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(o.SettingSection,null,(0,e.jsx)(t.CollapsablePanel,{label:p("panelDisplaySettings"),type:"default",level:1,role:"group","aria-label":p("panelDisplaySettings")},(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("maxResultsLabel","maxResultsDescription")},(0,e.jsx)(t.NumericInput,{css:h.fullWidth,value:parseInt(T,10),min:1,max:1e3,onChange:te,onBlur:ae,"aria-label":p("maxResultsLabel"),"aria-invalid":!!X.maxResults})),X.maxResults&&(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row},(0,e.jsx)(t.Alert,{css:h.fullWidth,type:"error",text:X.maxResults,closable:!1})),(0,e.jsx)(o.SettingRow,{flow:"no-wrap",level:1,css:h.row,label:w("enableToggleRemovalLabel","enableToggleRemovalDescription")},(0,e.jsx)(t.Switch,{checked:L,onChange:oe,"aria-label":p("enableToggleRemovalLabel")})),(0,e.jsx)(o.SettingRow,{flow:"no-wrap",level:1,css:h.row,label:w("enablePIIMaskingLabel","enablePIIMaskingDescription")},(0,e.jsx)(t.Switch,{checked:O,onChange:le,"aria-label":p("enablePIIMaskingLabel")})),(0,e.jsx)(o.SettingRow,{flow:"no-wrap",level:1,css:h.row,label:w("autoZoomOnSelectionLabel","autoZoomOnSelectionDescription")},(0,e.jsx)(t.Switch,{checked:P,onChange:ge,"aria-label":p("autoZoomOnSelectionLabel")})),(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("allowedHostsLabel","allowedHostsDescription")},(0,e.jsx)("div",{css:h.allowedHostInputRow},(0,e.jsx)(t.TextInput,{css:h.allowedHostInput,value:U,onChange:re,onKeyDown:de,placeholder:p("allowedHostsPlaceholder"),"aria-label":p("allowedHostsLabel"),spellCheck:!1}),(0,e.jsx)(t.Button,{type:"default",icon:!0,onClick:ue,title:p("addAllowedHostLabel"),"aria-label":p("addAllowedHostLabel"),disabled:!Oe,css:h.addAllowedHostButton},(0,e.jsx)(t.SVG,{src:I(),size:16})))),(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row},(0,e.jsx)("div",{css:h.allowedHostList},W.length>0?W.map((a=>(0,e.jsx)("div",{css:h.allowedHostListRow,key:a},(0,e.jsx)(t.TextInput,{css:h.allowedHostListInput,value:a,readOnly:!0,borderless:!0,disabled:!0,spellCheck:!1,"aria-label":`${p("allowedHostsListLabel")}: ${a}`}),(0,e.jsx)(t.Button,{type:"tertiary",icon:!0,onClick:()=>ce(a),title:p("removeAllowedHostLabel"),"aria-label":p("removeAllowedHostLabel")},(0,e.jsx)(t.SVG,{src:M(),size:16}))))):(0,e.jsx)("div",{css:h.description,role:"status","aria-live":"polite"},p("allowedHostsEmptyHint")))))),(0,e.jsx)(o.SettingSection,null,(0,e.jsx)(t.CollapsablePanel,{label:p("panelHighlightSettings"),type:"default",level:1,role:"group","aria-label":p("panelHighlightSettings")},(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("highlightColorLabel","highlightColorLabelTooltip")},(0,e.jsx)(a.ColorPicker,{css:h.fullWidth,color:Z,onChange:pe,"aria-label":p("highlightColorLabel")})),(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("highlightOpacityLabel","highlightOpacityLabelTooltip")},(0,e.jsx)("div",{css:h.sliderWrap},(0,e.jsx)("div",{css:h.sliderTrack},(0,e.jsx)(t.Slider,{value:me,min:0,max:100,step:5,tooltip:!0,formatter:j,"aria-label":p("highlightOpacityLabel"),onChange:he,css:h.sliderControl}),(0,e.jsx)("div",{css:h.sliderValue,role:"status","aria-live":"polite"},Te)))),(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("highlightOutlineWidthLabel","highlightOutlineWidthLabelTooltip")},(0,e.jsx)("div",{css:h.sliderWrap},(0,e.jsx)("div",{css:h.sliderTrack},(0,e.jsx)(t.Slider,{value:fe,min:.5,max:10,step:.5,tooltip:!0,formatter:N,"aria-label":p("highlightOutlineWidthLabel"),onChange:Ie,css:h.sliderControl}),(0,e.jsx)("div",{css:h.sliderValue,role:"status","aria-live":"polite"},Le))))))),ve&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(o.SettingSection,null,(0,e.jsx)(t.CollapsablePanel,{label:p("advancedSettingsTitle"),type:"default",level:1,role:"group","aria-label":p("advancedSettingsTitle")},(0,e.jsx)(o.SettingRow,{flow:"no-wrap",level:1,css:h.row,label:w("enableBatchOwnerQueryLabel","enableBatchOwnerQueryDescription")},(0,e.jsx)(t.Switch,{checked:E,onChange:ie,"aria-label":p("enableBatchOwnerQueryLabel")})),E&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row,label:w("relationshipIdLabel","relationshipIdDescription")},(0,e.jsx)(t.NumericInput,{css:h.fullWidth,value:parseInt(R,10),min:0,max:99,onChange:se,onBlur:ne,"aria-label":p("relationshipIdLabel"),title:p("relationshipIdTooltip"),"aria-invalid":!!X.relationshipId})),X.relationshipId&&(0,e.jsx)(o.SettingRow,{flow:"wrap",level:1,css:h.row},(0,e.jsx)(t.Alert,{css:h.fullWidth,type:"error",text:X.relationshipId,closable:!1})))))))};function m(e){u.p=e}})(),c})())}}}));